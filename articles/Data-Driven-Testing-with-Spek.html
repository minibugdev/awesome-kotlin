<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Data Driven Testing with Spek </title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link rel='stylesheet' href='./styles.css'>
  <link href='https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600' rel='stylesheet' type='text/css'>
</head>
<body>
<div id="layout" class="layout">
  <header class="article-nav">
    <button class="menu-link">
      <!-- Hamburger icon -->
      <span></span>
    </button>
    <div class="article-nav-links">
      <a href="Never-say-final-mocking-Kotlin-classes-in-unit-tests.html" class="article-nav-link article-nav-link--prev">previous</a>
      <a href="Kotlin-1-0-3-Is-Here.html" class="article-nav-link article-nav-link--next">next</a>
    </div>
  </header>

  <aside id="menu" class="menu">
    <div class="pure-menu">
      <ul class="pure-menu-list">
        <li class="pure-menu-list-date">Aug 21, 2016</li><li><a href="./Scala-vs-Kotlin-inline-and-infix.html">Scala vs Kotlin: inline and infix</a></li>
<li class="pure-menu-list-date">Aug 20, 2016</li><li><a href="./Decision-Trees-with-Kotlin.html">Decision Trees with Kotlin</a></li>
<li><a href="./Kotlin-The-Good-The-Bad-and-The-Ugly.html">Kotlin: The Good, The Bad, and The Ugly</a></li>
<li class="pure-menu-list-date">Aug 17, 2016</li><li><a href="./The-Next-Language-You-Thought-You-Didn’t-Need.html">The Next Language You Thought You Didn’t Need</a></li>
<li class="pure-menu-list-date">Aug 10, 2016</li><li><a href="./PaperParcel-with-Kotlin.html">PaperParcel with Kotlin</a></li>
<li><a href="./Issues-Faced-With-Kotlin-During-Android-Development.html">Issues Faced With Kotlin During Android Development</a></li>
<li><a href="./Lessons-from-converting-an-app-to-100-Kotlin.html">Lessons from converting an app to 100% Kotlin</a></li>
<li class="pure-menu-list-date">Aug 05, 2016</li><li><a href="./Writing-Gradle-Build-Scripts-in-Kotlin.html">Writing Gradle Build Scripts in Kotlin</a></li>
<li><a href="./More-readable-tests-with-Kotlin.html">More readable tests with Kotlin</a></li>
<li class="pure-menu-list-date">Aug 04, 2016</li><li><a href="./Calling-on-EAPers.html">Calling on EAPers</a></li>
<li class="pure-menu-list-date">Aug 03, 2016</li><li><a href="./Better-Android-Development-with-Kotlin-and-Gradle.html">Better Android Development with Kotlin and Gradle</a></li>
<li><a href="./Andrey-Breslav-Kotlin-Coroutines-JVMLS-2016.html">Andrey Breslav: Kotlin Coroutines, JVMLS 2016</a></li>
<li class="pure-menu-list-date">Jul 28, 2016</li><li><a href="./KotlinLifeguard-1.html">KotlinLifeguard #1</a></li>
<li class="pure-menu-list-date">Jul 27, 2016</li><li><a href="./UI-Testing-separating-Assertions-from-Actions-with-Kotlin-DSL.html">UI Testing: separating Assertions from Actions with Kotlin DSL</a></li>
<li class="pure-menu-list-date">Jul 26, 2016</li><li><a href="./JUnit-5-with-Spring-Boot-plus-Kotlin.html">JUnit 5 with Spring Boot (plus Kotlin)</a></li>
<li class="pure-menu-list-date">Jul 25, 2016</li><li><a href="./Things-We-ve-Learned-During-Coolcal-Development-in-Kotlin.html">Things We've Learned During Coolcal Development in Kotlin</a></li>
<li class="pure-menu-list-date">Jul 24, 2016</li><li><a href="./Scala-vs-Kotlin-Operator-overloading.html">Scala vs Kotlin: Operator overloading</a></li>
<li class="pure-menu-list-date">Jul 14, 2016</li><li><a href="./First-glimpse-of-Kotlin-1-1-Coroutines-Type-aliases-and-more.html">First glimpse of Kotlin 1.1: Coroutines, Type aliases and more</a></li>
<li class="pure-menu-list-date">Jul 10, 2016</li><li><a href="./Scala-vs-Kotlin-Pimp-my-library.html">Scala vs Kotlin: Pimp my library</a></li>
<li class="pure-menu-list-date">Jul 06, 2016</li><li><a href="./Never-say-final-mocking-Kotlin-classes-in-unit-tests.html">Never say final: mocking Kotlin classes in unit tests</a></li>
<li class="pure-menu-list-date">Jul 03, 2016</li><li><a href="./Data-Driven-Testing-with-Spek.html">Data Driven Testing with Spek </a></li>
<li class="pure-menu-list-date">Jun 30, 2016</li><li><a href="./Kotlin-1-0-3-Is-Here.html">Kotlin 1.0.3 Is Here!</a></li>
<li class="pure-menu-list-date">Jun 25, 2016</li><li><a href="./How-to-get-IDEA-to-detect-kotlin-generated-sources-using-Gradle.html">How to get IDEA to detect kotlin generated sources using Gradle</a></li>
<li class="pure-menu-list-date">Jun 20, 2016</li><li><a href="./Ad-hoc-polymorphism-in-Kotlin.html">Ad-hoc polymorphism in Kotlin</a></li>
<li><a href="./Kotlin-null-safety-and-its-performance-considerations-part-1.html">Kotlin null safety and its performance considerations -- part 1</a></li>
<li class="pure-menu-list-date">Jun 17, 2016</li><li><a href="./Kotlin-Native.html">Kotlin Native</a></li>
<li class="pure-menu-list-date">Jun 14, 2016</li><li><a href="./Kotlin-Night-in-San-Francisco-Recordings.html">Kotlin Night in San Francisco Recordings</a></li>
<li><a href="./News-from-KotlinTest.html">News from KotlinTest</a></li>
<li class="pure-menu-list-date">Jun 13, 2016</li><li><a href="./Meet-the-Kotlin-Team-at-Gradle-Summit.html">Meet the Kotlin Team at Gradle Summit</a></li>
<li class="pure-menu-list-date">Jun 09, 2016</li><li><a href="./Архитектор-Kotlin-Язык-программирования-—-рабочий-инструмент-Если-никогда-их-не-менять-можно-отстать-от-жизни-.html">Архитектор Kotlin: «Язык программирования — рабочий инструмент. Если никогда их не менять, можно отстать от жизни» </a></li>
<li class="pure-menu-list-date">Jun 08, 2016</li><li><a href="./Kotlin-1-0-3-EAP.html">Kotlin 1.0.3 EAP</a></li>
<li class="pure-menu-list-date">Jun 06, 2016</li><li><a href="./When-Kotlin-met-Gradle.html">When Kotlin met Gradle</a></li>
<li class="pure-menu-list-date">Jun 03, 2016</li><li><a href="./Kotlin-Eclipse-Plugin-0-7-Is-Here.html">Kotlin Eclipse Plugin 0.7 Is Here!</a></li>
<li class="pure-menu-list-date">Jun 02, 2016</li><li><a href="./What’s-in-store-for-Kotlin-this-year.html">What’s in store for Kotlin this year</a></li>
<li class="pure-menu-list-date">Jun 01, 2016</li><li><a href="./Where-We-Stand-What-s-Next-for-Kotlin.html">Where We Stand & What's Next for Kotlin</a></li>
<li class="pure-menu-list-date">May 30, 2016</li><li><a href="./Neural-Networks-in-Kotlin-part-2.html">Neural Networks in Kotlin (part 2)</a></li>
<li class="pure-menu-list-date">May 27, 2016</li><li><a href="./Neural-Network-in-Kotlin.html">Neural Network in Kotlin</a></li>
<li class="pure-menu-list-date">May 24, 2016</li><li><a href="./You-can-do-Better-with-Kotlin.html">You can do Better with Kotlin</a></li>
<li class="pure-menu-list-date">May 20, 2016</li><li><a href="./Kotlin-dragging-java-into-the-modern-world.html">Kotlin, dragging java into the modern world</a></li>
<li class="pure-menu-list-date">May 18, 2016</li><li><a href="./Gradle-Meets-Kotlin.html">Gradle Meets Kotlin</a></li>
<li><a href="./Kotlin-Meets-Gradle.html">Kotlin Meets Gradle</a></li>
<li class="pure-menu-list-date">May 17, 2016</li><li><a href="./Gradle-Elevates-the-Build-to-First-Class-Programming-With-Kotlin-Language.html">Gradle Elevates the Build to First-Class Programming With Kotlin Language</a></li>
<li class="pure-menu-list-date">May 13, 2016</li><li><a href="./Kotlin-1-0-2-is-Here.html">Kotlin 1.0.2 is Here</a></li>
<li class="pure-menu-list-date">May 12, 2016</li><li><a href="./Kosent.html">Kosent</a></li>
<li class="pure-menu-list-date">May 10, 2016</li><li><a href="./Testing-in-Kotlin.html">Testing in Kotlin</a></li>
<li class="pure-menu-list-date">May 01, 2016</li><li><a href="./JMock-and-Kotlin.html">JMock and Kotlin</a></li>
<li class="pure-menu-list-date">Apr 29, 2016</li><li><a href="./Exercises-in-Kotlin-Part-5-Classes.html">Exercises in Kotlin: Part 5 - Classes</a></li>
<li class="pure-menu-list-date">Apr 27, 2016</li><li><a href="./Exercises-in-Kotlin-Part-4-Control-flows-and-return.html">Exercises in Kotlin: Part 4 - Control flows and return</a></li>
<li class="pure-menu-list-date">Apr 24, 2016</li><li><a href="./Writing-Concise-Code-With-Kotlin.html">Writing Concise Code With Kotlin</a></li>
<li><a href="./Type-safe-JavaFX-CSS-with-TornadoFX.html">Type safe JavaFX CSS with TornadoFX</a></li>
<li class="pure-menu-list-date">Apr 21, 2016</li><li><a href="./JDK7-8-features-in-Kotlin-1-0.html">JDK7/8 features in Kotlin 1.0</a></li>
<li><a href="./Kotlin-Android.html">Kotlin + Android</a></li>
<li class="pure-menu-list-date">Apr 20, 2016</li><li><a href="./Kotlin-Android-First-Impressions.html">Kotlin + Android First Impressions</a></li>
<li><a href="./Exercises-in-Kotlin-Part-3-Functions.html">Exercises in Kotlin: Part 3 - Functions</a></li>
<li class="pure-menu-list-date">Apr 19, 2016</li><li><a href="./Exercises-in-Kotlin-Part-2-High-level-syntax-and-Variables.html">Exercises in Kotlin: Part 2 - High level syntax and Variables</a></li>
<li class="pure-menu-list-date">Apr 18, 2016</li><li><a href="./Exercises-in-Kotlin-Part-1-Getting-Started.html">Exercises in Kotlin: Part 1 - Getting Started</a></li>
<li class="pure-menu-list-date">Apr 17, 2016</li><li><a href="./Code-improvements-with-Kotlin.html">Code improvements with Kotlin</a></li>
<li class="pure-menu-list-date">Apr 15, 2016</li><li><a href="./Few-thoughts-about-Kotlin-and-why-I-like-it-so-much.html">Few thoughts about Kotlin and why I like it so much</a></li>
<li class="pure-menu-list-date">Apr 14, 2016</li><li><a href="./Kotlin-for-Scala-Developers.html">Kotlin for Scala Developers</a></li>
<li><a href="./Kotlin-Post-1-0-Roadmap.html">Kotlin Post-1.0 Roadmap</a></li>
<li class="pure-menu-list-date">Apr 11, 2016</li><li><a href="./Making-Android-Development-Easier.html">Making Android Development Easier</a></li>
<li class="pure-menu-list-date">Apr 09, 2016</li><li><a href="./Keddit — Part-7-Infinite-Scroll-Higher-Order-functions-Lambdas.html">Keddit — Part 7: Infinite Scroll: Higher-Order functions & Lambdas</a></li>
<li><a href="./The-Kobalt-diaries-Automatic-Android-SDK-management.html">The Kobalt diaries: Automatic Android SDK management</a></li>
<li class="pure-menu-list-date">Apr 07, 2016</li><li><a href="./Android-And-Kotlin.html">Android And Kotlin</a></li>
<li class="pure-menu-list-date">Apr 06, 2016</li><li><a href="./Kotlin-Digest-2016-Q1.html">Kotlin Digest 2016.Q1</a></li>
<li><a href="./Kotlin-DSL-Anko.html">Kotlin DSL: Anko</a></li>
<li class="pure-menu-list-date">Apr 04, 2016</li><li><a href="./Kotlin-Practical-Experience.html">Kotlin: Practical Experience</a></li>
<li><a href="./Kotlin’s-killer-features.html">Kotlin’s killer features</a></li>
<li><a href="./Exploring-Delegation-in-Kotlin.html">Exploring Delegation in Kotlin</a></li>
<li class="pure-menu-list-date">Apr 03, 2016</li><li><a href="./Experimental-Kotlin-and-mutation-testing.html">Experimental: Kotlin and mutation testing</a></li>
<li class="pure-menu-list-date">Mar 31, 2016</li><li><a href="./10-Features-I-Wish-Java-Would-Steal-From-the-Kotlin-Language.html">10 Features I Wish Java Would Steal From the Kotlin Language</a></li>
<li class="pure-menu-list-date">Mar 30, 2016</li><li><a href="./Ubuntu-Make-16-03-Released-With-Eclipse-JEE-And-IntelliJ-IDEA-EAP-Support-More.html">Ubuntu Make 16.03 Released With Eclipse JEE And IntelliJ IDEA EAP Support, More</a></li>
<li><a href="./Kotlin’s-Android-Roadmap.html">Kotlin’s Android Roadmap</a></li>
<li class="pure-menu-list-date">Mar 29, 2016</li><li><a href="./Rest-API-plumbing-with-kotlin.html">Rest API plumbing with kotlin</a></li>
<li class="pure-menu-list-date">Mar 28, 2016</li><li><a href="./Creating-an-AndroidWear-watchface-using-Kotlin.html">Creating an AndroidWear watchface using Kotlin</a></li>
<li class="pure-menu-list-date">Mar 22, 2016</li><li><a href="./Writing-a-RESTful-backend-using-Kotlin-and-Spring-Boot.html">Writing a RESTful backend using Kotlin and Spring Boot</a></li>
<li><a href="./How-to-Hot-Deploy-Java-Kotlin-classes-in-Dev.html">How to Hot Deploy Java/Kotlin classes in Dev</a></li>
<li><a href="./RU-Андрей-Бреслав-и-Дмитрий-Жемеров-о-Kotlin-1-0-на-jug-msk-ru.html">(RU) Андрей Бреслав и Дмитрий Жемеров о Kotlin 1.0 на jug.msk.ru</a></li>
<li class="pure-menu-list-date">Mar 20, 2016</li><li><a href="./A-Geospatial-Messenger-with-Kotlin-Spring-Boot-and-PostgreSQL.html">A Geospatial Messenger with Kotlin, Spring Boot and PostgreSQL</a></li>
<li class="pure-menu-list-date">Mar 19, 2016</li><li><a href="./Algebraic-Data-Types-In-Kotlin.html">Algebraic Data Types In Kotlin</a></li>
<li><a href="./Kotlin-Month-Post-4-Properties.html">Kotlin Month Post 4: Properties</a></li>
<li class="pure-menu-list-date">Mar 17, 2016</li><li><a href="./Kotlin-Educational-Plugin.html">Kotlin Educational Plugin</a></li>
<li class="pure-menu-list-date">Mar 16, 2016</li><li><a href="./Using-Kotlin-For-Tests-in-Android.html">Using Kotlin For Tests in Android</a></li>
<li><a href="./Kotlin-1-0-1-is-Here.html">Kotlin 1.0.1 is Here!</a></li>
<li><a href="./Kotlin-recipes-for-Android-I-OnGlobalLayoutListener.html">Kotlin recipes for Android (I): OnGlobalLayoutListener</a></li>
<li class="pure-menu-list-date">Mar 15, 2016</li><li><a href="./Kotlin-Retrofit-RxAndroid-Realm.html">Kotlin : Retrofit + RxAndroid + Realm</a></li>
<li class="pure-menu-list-date">Mar 14, 2016</li><li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Wrap-Up.html">Kotlin & Android: A Brass Tacks Experiment Wrap-Up</a></li>
<li class="pure-menu-list-date">Mar 13, 2016</li><li><a href="./Kotlin-Month-Post-3-Safety.html">Kotlin Month Post 3: Safety</a></li>
<li><a href="./Feedback-on-the-Josephus-problem.html">Feedback on the Josephus problem</a></li>
<li class="pure-menu-list-date">Mar 11, 2016</li><li><a href="./RU-SDCast-41-в-гостях-Андрей-Бреслав-руководитель-проекта-Kotlin-в-компании-JetBrains.html">(RU) SDCast #41: в гостях Андрей Бреслав, руководитель проекта Kotlin в компании JetBrains</a></li>
<li><a href="./Why-I-don-t-want-to-use-Kotlin-for-Android-Development-yet.html">Why I don't want to use Kotlin for Android Development yet</a></li>
<li class="pure-menu-list-date">Mar 09, 2016</li><li><a href="./Getting-Started-with-Kotlin-and-Anko-on-Android.html">Getting Started with Kotlin and Anko on Android</a></li>
<li><a href="./RU-Дмитрий-Полищук-Kotlin-Android-практический-ликбез.html">(RU) Дмитрий Полищук - Kotlin + Android: практический ликбез</a></li>
<li class="pure-menu-list-date">Mar 08, 2016</li><li><a href="./A-DSL-Workbench-with-Gradle-and-Kotlin.html">A DSL Workbench with Gradle and Kotlin</a></li>
<li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-6.html">Kotlin & Android: A Brass Tacks Experiment, Part 6</a></li>
<li class="pure-menu-list-date">Mar 06, 2016</li><li><a href="./Solving-the-Josephus-problem-in-Kotlin.html">Solving the Josephus problem in Kotlin</a></li>
<li class="pure-menu-list-date">Mar 05, 2016</li><li><a href="./Kotlin-Month-Post-2-Inheritance-and-Defaults.html">Kotlin Month Post 2: Inheritance and Defaults</a></li>
<li class="pure-menu-list-date">Mar 04, 2016</li><li><a href="./Building-a-Kotlin-project-2-2.html">Building a Kotlin project 2/2</a></li>
<li><a href="./Building-a-Kotlin-project-1-2.html">Building a Kotlin project 1/2</a></li>
<li><a href="./RU-Видео-со-встречи-JUG-ru-с-разработчиками-Kotlin.html">(RU) Видео со встречи JUG.ru с разработчиками Kotlin</a></li>
<li class="pure-menu-list-date">Mar 03, 2016</li><li><a href="./Kotlin-a-new-JVM-language-you-should-try.html">Kotlin: a new JVM language you should try</a></li>
<li class="pure-menu-list-date">Mar 02, 2016</li><li><a href="./RU-Kotlin-для-начинающих.html">(RU) Kotlin для начинающих</a></li>
<li class="pure-menu-list-date">Mar 01, 2016</li><li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-5.html">Kotlin & Android: A Brass Tacks Experiment, Part 5</a></li>
<li><a href="./Developing-on-Android-sucks-a-lot-less-with-Kotlin.html">Developing on Android sucks a lot less with Kotlin</a></li>
<li class="pure-menu-list-date">Feb 29, 2016</li><li><a href="./The-Journey-of-a-Spring-Boot-application-from-Java-8-to-Kotlin-part-3-Data-Classes.html">The Journey of a Spring Boot application from Java 8 to Kotlin, part 3: Data Classes</a></li>
<li><a href="./Как-себе-выстрелить-в-ногу-в-Kotlin.html">Как себе выстрелить в ногу в Kotlin</a></li>
<li class="pure-menu-list-date">Feb 28, 2016</li><li><a href="./Kotlin-and-Ceylon.html">Kotlin and Ceylon</a></li>
<li class="pure-menu-list-date">Feb 27, 2016</li><li><a href="./Kotlin-Month-Post-1-Assorted-Features.html">Kotlin Month Post 1: Assorted Features</a></li>
<li class="pure-menu-list-date">Feb 24, 2016</li><li><a href="./Kotlin-2-Years-On.html">Kotlin - 2 Years On</a></li>
<li class="pure-menu-list-date">Feb 23, 2016</li><li><a href="./The-Journey-of-a-Spring-Boot-application-from-Java-8-to-Kotlin-part-2-Configuration-Classes.html">The Journey of a Spring Boot application from Java 8 to Kotlin, part 2: Configuration Classes</a></li>
<li><a href="./An-Introduction-to-Kotlin.html">An Introduction to Kotlin</a></li>
<li><a href="./Kotlin-1-0-is-finally-released.html">Kotlin 1.0 is finally released!</a></li>
<li class="pure-menu-list-date">Feb 22, 2016</li><li><a href="./More-Kotlin-Features-to-Love.html">More Kotlin Features to Love</a></li>
<li><a href="./A-Very-Peculiar-but-Possibly-Cunning-Kotlin-Language-Feature.html">A Very Peculiar, but Possibly Cunning Kotlin Language Feature.</a></li>
<li><a href="./Kotlin-Easily-storing-a-list-in-SharedPreferences-with-Custom-Accessors.html">Kotlin: Easily storing a list in SharedPreferences with Custom Accessors</a></li>
<li class="pure-menu-list-date">Feb 21, 2016</li><li><a href="./Kotlin — Love-at-first-line.html">Kotlin — Love at first line</a></li>
<li class="pure-menu-list-date">Feb 20, 2016</li><li><a href="./RU-Радио-Т-484.html">(RU) Радио-Т 484</a></li>
<li><a href="./RU-DevZen-Podcast-Kotlin-и-Vulkan-1-0-—-Episode-0080.html">(RU) DevZen Podcast: Kotlin и Vulkan 1.0 — Episode 0080.</a></li>
<li><a href="./The-Kobalt-diaries-testing.html">The Kobalt diaries: testing</a></li>
<li><a href="./RU-Немного-о-Kotlin.html">(RU) Немного о Kotlin.</a></li>
<li><a href="./Weekend-resources-for-new-Kotlin-programmers.html">Weekend resources for new Kotlin programmers</a></li>
<li><a href="./Using-Mockito-for-unit-testing-with-Kotlin-1-x.html">Using Mockito for unit testing with Kotlin (1/x)</a></li>
<li class="pure-menu-list-date">Feb 19, 2016</li><li><a href="./RU-Kotlin-1-0-Задай-вопрос-команде.html">(RU) Kotlin 1.0. Задай вопрос команде.</a></li>
<li class="pure-menu-list-date">Feb 16, 2016</li><li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-3.html">Kotlin & Android: A Brass Tacks Experiment, Part 3.</a></li>
<li><a href="./Kotlin-1-0-The-good-the-bad-and-the-evident.html">Kotlin 1.0: The good, the bad and the evident.</a></li>
<li><a href="./RU-Релиз-Kotlin-1-0-языка-программирования-для-JVM-и-Android.html">(RU) Релиз Kotlin 1.0, языка программирования для JVM и Android.</a></li>
<li class="pure-menu-list-date">Feb 15, 2016</li><li><a href="./JVM-Newcomer-Kotlin-1-0-is-GA.html">JVM Newcomer Kotlin 1.0 is GA</a></li>
<li><a href="./Developing-Spring-Boot-applications-with-Kotlin.html">Developing Spring Boot applications with Kotlin.</a></li>
<li><a href="./Kotlin-1-0-Released-Pragmatic-Language-for-JVM-and-Android.html">Kotlin 1.0 Released: Pragmatic Language for JVM and Android</a></li>
<li class="pure-menu-list-date">Feb 13, 2016</li><li><a href="./The-Journey-of-a-Spring-Boot-application-from-Java-8-to-Kotlin-The-Application-Class.html">The Journey of a Spring Boot application from Java 8 to Kotlin: The Application Class</a></li>
<li class="pure-menu-list-date">Feb 04, 2016</li><li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-4.html">Kotlin & Android: A Brass Tacks Experiment, Part 4</a></li>
<li><a href="./RU-Podcast-Разбор-Полетов-Episode-102-—-Kotlin-тесты-и-здоровый-сон.html">(RU) Podcast Разбор Полетов: Episode 102 — Kotlin, тесты и здоровый сон.</a></li>
<li><a href="./Kotlin-1-0-Release-Candidate-is-Out.html">Kotlin 1.0 Release Candidate is Out!</a></li>
<li class="pure-menu-list-date">Feb 03, 2016</li><li><a href="./Kotlin-Coding.html">Kotlin Coding</a></li>
<li class="pure-menu-list-date">Feb 02, 2016</li><li><a href="./10-Kotlin-Tutorials-for-Beginners-Dive-Into-Kotlin-Programming.html">10 Kotlin Tutorials for Beginners: Dive Into Kotlin Programming</a></li>
<li class="pure-menu-list-date">Feb 01, 2016</li><li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-2.html">Kotlin & Android: A Brass Tacks Experiment, Part 2.</a></li>
<li><a href="./Kotlin-Android-A-Brass-Tacks-Experiment-Part-1.html">Kotlin & Android: A Brass Tacks Experiment, Part 1.</a></li>
<li class="pure-menu-list-date">Jan 25, 2016</li><li><a href="./KillerTask-the-solution-to-AsyncTask-implementation.html">KillerTask, the solution to AsyncTask implementation</a></li>
<li class="pure-menu-list-date">Jan 23, 2016</li><li><a href="./My-Kotlin-Adventure.html">My Kotlin Adventure</a></li>
<li class="pure-menu-list-date">Jan 16, 2016</li><li><a href="./Mimicking-Kotlin-Builders-in-Java-and-Python.html">Mimicking Kotlin Builders in Java and Python</a></li>
<li class="pure-menu-list-date">Jan 15, 2016</li><li><a href="./Android-development-with-Kotlin.html">Android development with Kotlin</a></li>
<li><a href="./Kotlin-the-somewhat-obscure-modern-Android-friendly-programming-language.html">Kotlin, the somewhat obscure modern Android-friendly programming language</a></li>
<li class="pure-menu-list-date">Jan 14, 2016</li><li><a href="./Fun-with-Kotlin.html">Fun with Kotlin</a></li>
<li class="pure-menu-list-date">Jan 10, 2016</li><li><a href="./Playing-with-Spring-Boot-Vaadin-and-Kotlin.html">Playing with Spring Boot, Vaadin and Kotlin</a></li>
<li class="pure-menu-list-date">Jan 06, 2016</li><li><a href="./Kotlin-XML-Binding.html">Kotlin XML Binding</a></li>
<li class="pure-menu-list-date">Dec 30, 2015</li><li><a href="./Early-Impressions-of-Kotlin.html">Early Impressions of Kotlin</a></li>
<li class="pure-menu-list-date">Dec 12, 2015</li><li><a href="./Kotlin-for-Java-Developers-10-Features-You-Will-Love-About-Kotlin.html">Kotlin for Java Developers: 10 Features You Will Love About Kotlin</a></li>
<li class="pure-menu-list-date">Nov 11, 2015</li><li><a href="./Setting-up-Kotlin-with-Android-and-tests.html">Setting up Kotlin with Android and tests</a></li>
<li class="pure-menu-list-date">Nov 05, 2015</li><li><a href="./Functional-Programming-with-Kotlin.html">Functional Programming with Kotlin</a></li>
<li class="pure-menu-list-date">Oct 30, 2015</li><li><a href="./Exploring-the-Kotlin-standard-library.html">Exploring the Kotlin standard library</a></li>
<li class="pure-menu-list-date">Oct 22, 2015</li><li><a href="./Kotlin-NoSQL-for-MongoDB-in-Action.html">Kotlin NoSQL for MongoDB in Action</a></li>
<li class="pure-menu-list-date">Sep 21, 2015</li><li><a href="./Quasar-Efficient-and-Elegant-Fibers-Channels-and-Actors.html">Quasar: Efficient and Elegant Fibers, Channels and Actors</a></li>
<li class="pure-menu-list-date">Sep 18, 2015</li><li><a href="./Kotlin-❤-FP.html">Kotlin ❤ FP</a></li>
<li class="pure-menu-list-date">Aug 26, 2015</li><li><a href="./Production-Ready-Kotlin.html">Production Ready Kotlin</a></li>
<li class="pure-menu-list-date">Aug 12, 2015</li><li><a href="./JVMLS-2015-Flexible-Types-in-Kotlin.html">JVMLS 2015 - Flexible Types in Kotlin</a></li>
<li class="pure-menu-list-date">Aug 06, 2015</li><li><a href="./Building-APIs-on-the-JVM-Using-Kotlin-and-Spark-–-Part-1.html">Building APIs on the JVM Using Kotlin and Spark – Part 1</a></li>
<li class="pure-menu-list-date">Jul 31, 2015</li><li><a href="./RU-Без-слайдов-интервью-с-Дмитрием-Жемеровым-из-JetBrains.html">(RU) Без слайдов: интервью с Дмитрием Жемеровым из JetBrains</a></li>
<li class="pure-menu-list-date">Jul 20, 2015</li><li><a href="./Android-Kotlin-3.html">Android + Kotlin = <3</a></li>
<li class="pure-menu-list-date">Jul 06, 2015</li><li><a href="./Why-Kotlin-is-my-next-programming-language.html">Why Kotlin is my next programming language</a></li>
<li class="pure-menu-list-date">Jun 27, 2015</li><li><a href="./Exploring-Kotlin.html">Exploring Kotlin</a></li>
<li><a href="./RxAndroid-and-Kotlin-Part-1.html">RxAndroid and Kotlin (Part 1)</a></li>
<li class="pure-menu-list-date">Jun 04, 2015</li><li><a href="./Quasar-and-Kotlin-a-Powerful-Match.html">Quasar and Kotlin - a Powerful Match</a></li>
<li class="pure-menu-list-date">May 09, 2015</li><li><a href="./Kotlin-New-Hope-in-a-Java-6-Wasteland.html">Kotlin: New Hope in a Java 6 Wasteland</a></li>
<li class="pure-menu-list-date">Dec 11, 2014</li><li><a href="./Kotlin-for-Java-developers.html">Kotlin for Java developers</a></li>
<li class="pure-menu-list-date">Dec 01, 2014</li><li><a href="./Non-trivial-constructors-in-Kotlin.html">Non-trivial constructors in Kotlin</a></li>
<li class="pure-menu-list-date">Nov 03, 2014</li><li><a href="./GeeCON-Prague-2014-Andrey-Cheptsov-A-Reactive-and-Type-safe-Kotlin-DSL-for-NoSQL-and-SQL.html">GeeCON Prague 2014: Andrey Cheptsov - A Reactive and Type-safe Kotlin DSL for NoSQL and SQL</a></li>
<li class="pure-menu-list-date">Sep 10, 2014</li><li><a href="./Kotlin-vs-Java-puzzlers.html">Kotlin vs Java puzzlers</a></li>
<li class="pure-menu-list-date">Apr 02, 2013</li><li><a href="./The-Advent-of-Kotlin-A-Conversation-with-JetBrains-Andrey-Breslav.html">The Advent of Kotlin: A Conversation with JetBrains' Andrey Breslav</a></li>
<li class="pure-menu-list-date">Feb 07, 2013</li><li><a href="./Exploring-the-Kotlin-Standard-Library-Part-3.html">Exploring the Kotlin Standard Library - Part 3</a></li>
<li class="pure-menu-list-date">Jan 25, 2013</li><li><a href="./Exploring-the-Kotlin-Standard-Library-Part-2.html">Exploring the Kotlin Standard Library - Part 2</a></li>
<li class="pure-menu-list-date">Jan 23, 2013</li><li><a href="./The-Adventurous-Developer’s-Guide-to-JVM-languages-–-Kotlin.html">The Adventurous Developer’s Guide to JVM languages – Kotlin</a></li>
<li class="pure-menu-list-date">Jan 22, 2013</li><li><a href="./Exploring-the-Kotlin-Standard-Library-Part-1.html">Exploring the Kotlin Standard Library - Part 1</a></li>
      </ul>
    </div>
  </aside>

  <section id="main" class="main">
    <div class="main-content">
      <h1>
        <a href="http://engineering.pivotal.io/post/spek-data-driven-tests/">Data Driven Testing with Spek </a> - <span class="main-title-date">Jul 03, 2016</span>
      </h1>
      <h2>by Konstantin Semenov</h2>
      <p>Several days ago, when we were developing a parser in Kotlin, we found ourselves copying and pasting series of tests with slight adjustments. This has become really annoying, especially when we thought of all the tests we would need to change every time the behaviour of our parser is going to change. As we have used Spock on previous projects, we wanted to replicate Spock&#x27;s <a href="https://spockframework.github.io/spock/docs/1.0/data_driven_testing.html">Data Driven Testing</a> approach in <a href="https://jetbrains.github.io/spek/">Spek</a>.</p>
<h2>Spock Example</h2>
<p>Before diving into the Kotlin exploration, let&#x27;s quickly review the Spock interface for data driven testing. Spock provides means for defining easily readable tests, and even supports inclusion of test data into the test name using the <code>@Unroll</code> annotation:</p>
<pre><code class="hljs language-groovy">    <span class="hljs-meta">@Unroll</span>
    <span class="hljs-keyword">def</span> <span class="hljs-string">"maximum of #a and #b is #c"</span>(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c) {
<span class="hljs-symbol">        expect:</span>
            Math.max(a, b) == c
<span class="hljs-symbol">
        where:</span>
            a | b | c
            <span class="hljs-number">1</span> | <span class="hljs-number">3</span> | <span class="hljs-number">3</span>
            <span class="hljs-number">7</span> | <span class="hljs-number">4</span> | <span class="hljs-number">4</span>
            <span class="hljs-number">0</span> | <span class="hljs-number">0</span> | <span class="hljs-number">0</span>
    }</code></pre>
<p>The definition above will yield three tests in the report:</p>
<pre><code>maximum of 1 and 3 is 3 [PASS]
maximum of 7 and 4 is 4 [FAIL]
maximum of 0 and 0 is 0 [PASS]
</code></pre>
<p>When the set of data is more complicated, a label can be included as part of the test data parameters:</p>
<pre><code class="hljs language-groovy">    <span class="hljs-meta">@Unroll</span>
    <span class="hljs-keyword">def</span> <span class="hljs-string">"maximum of two numbers when #testLabel"</span>(String testLabel, <span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c) {
<span class="hljs-symbol">        expect:</span>
            Math.max(a, b) == c
<span class="hljs-symbol">
        where:</span>
            testLabel                 | a | b | c
            <span class="hljs-string">"first number is bigger"</span>  | <span class="hljs-number">4</span> | <span class="hljs-number">1</span> | <span class="hljs-number">4</span>
            <span class="hljs-string">"second number is bigger"</span> | <span class="hljs-number">0</span> | <span class="hljs-number">5</span> | <span class="hljs-number">5</span>
            <span class="hljs-string">"numbers are equal"</span>       | <span class="hljs-number">3</span> | <span class="hljs-number">3</span> | <span class="hljs-number">3</span>
    }</code></pre>
<h2>Spek approach</h2>
<p>Originally we would like to replicate the features of Spock interface as close as possible.</p>
<p>In Spek, as of version 1.0, all tests are defined within a lambda that is supplied as a constructor argument. This provides flexibility needed to replicate the RSpec DSL, but imposes limitations such as preventing the use of annotations.</p>
<h3>Trusting your heroes</h3>
<p>For the sake of this article, let&#x27;s assume that we are writing a game in Kotlin, and we need to test the query methods in our <code>Hero</code> class that depend on the state our <code>Hero</code> is in. The state change can be triggered by calling an appropriate method, as per the skeleton defined below:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span></span>() {
    <span class="hljs-keyword">val</span> isRunning: <span class="hljs-built_in">Boolean</span> <span class="hljs-keyword">get</span>() = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">val</span> isStanding: <span class="hljs-built_in">Boolean</span> <span class="hljs-keyword">get</span>() = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">val</span> isJumping: <span class="hljs-built_in">Boolean</span> <span class="hljs-keyword">get</span>() = <span class="hljs-literal">false</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> {}
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stand</span><span class="hljs-params">()</span></span> {}
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">jump</span><span class="hljs-params">()</span></span> {}
}</code></pre>
<p>In contrast to the Spock example above, we need to run a series of tests for every state of the object. For every one of the four states (initial, running, standing and jumping), we would need to verify all three query methods. With Spock we would have to put the three assertions into a single test method.</p>
<h3>First attempt</h3>
<p>Our first approach was to use lists of arbitrary objects to emulate the Spock <code>when</code> table. Then all our test blocks can be dynamically defined while iterating over those lists:</p>
<pre><code class="hljs language-kotlin">class HeroTests: Spek({
    describe("query methods") {
        listOf(
            listOf("initial state", false, false, true, Hero()),
            listOf("when running", false, false, true, Hero().apply { run() }),
            listOf("when jumping", false, false, true, Hero().apply { jump() }),
            listOf("when standing", false, false, true, Hero().apply { stand() })
        ).forEach { test -&gt;
            describe(test.first) {
                fun testLabel(flag: Boolean, action: String): String = "${if (flag) "should" else "shouldn't"} be $action"

                it(testLabel(test[1], "running")) {
                    expect(test[1]) { test[4].isRunning }
                }

                it(testLabel(test[2], "walking")) {
                    expect(test[2]) { test[4].isWalking }
                }

                it(testLabel(test[3], "jumping")) {
                    expect(test[3]) { test[4].isJumping }
                }
            }
        }
    }
})</code></pre>
<p>When running these tests, we can get a very nicely organized output:</p>
<p><img src="https://dl.dropboxusercontent.com/u/364765/hero-tests-report.png" alt="HeroTests report"></p>
<blockquote>
<p><strong>Please note</strong></p>
<p>Only the platform test runner should be used in IDEA to get meaningful test reports for Spek tests. At the time of writing, Gradle test runner output was pretty confusing and rather useless. For the test case above it reported 48 tests named &quot;classMethod&quot;, and even though the stack trace for failed tests would indicate the point of failure, it is absolutely meaningless without knowledge of the failed iteration.</p>
</blockquote>
<p>We now have a fine-grained output, and adding a new set of tests straight away is fairly simple and straightforward. However, it is difficult to keep track of the value types and meanings. And maintaining these tests could become difficult over time, especially when you need to restructure the test data.</p>
<h3>Moving test data to a DTO</h3>
<p>In order to improve clarity and maintainability, we can replace the list of arbitrary objects with a DTO. Additionally, we can move some test reporting helpers, such as test and test group name generators, into that DTO as well:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroQueryTest</span></span>(<span class="hljs-keyword">val</span> state: String, <span class="hljs-keyword">val</span> subject: Hero, <span class="hljs-keyword">val</span> isRunning: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isJumping: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isStanding: <span class="hljs-built_in">Boolean</span>) {
    <span class="hljs-keyword">val</span> runningTestLabel = testLabel(isRunning, <span class="hljs-string">"running"</span>)
    <span class="hljs-keyword">val</span> standingTestLabel = testLabel(isStanding, <span class="hljs-string">"standing"</span>)
    <span class="hljs-keyword">val</span> jumpingTestLabel = testLabel(isJumping, <span class="hljs-string">"jumping"</span>)
    <span class="hljs-keyword">val</span> testGroupLabel = <span class="hljs-string">"when <span class="hljs-subst">$state</span>"</span>

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testLabel</span><span class="hljs-params">(condition: <span class="hljs-type">Boolean</span>, action: <span class="hljs-type">String</span>)</span></span> = <span class="hljs-keyword">if</span> (condition) <span class="hljs-string">"should be <span class="hljs-subst">$action</span>"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"shouldn't be <span class="hljs-subst">$action</span>"</span>
}</code></pre>
<p>In the code above, we could have used <a href="https://kotlinlang.org/docs/reference/reflection.html">introspection</a> to derive the action string from the property name, but that would require to drag in the heavy <code>kotlin-reflect.jar</code>, which might not be needed otherwise. But just in case you were wondering, this is how it might look like:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-keyword">import</span> kotlin.reflect.KProperty

<span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroQueryTest</span></span>(<span class="hljs-keyword">val</span> state: String, <span class="hljs-keyword">val</span> subject: Hero, <span class="hljs-keyword">val</span> isRunning: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isJumping: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isStanding: <span class="hljs-built_in">Boolean</span>) {
    <span class="hljs-keyword">val</span> runningTestLabel = HeroQueryTest::isRunning.testLabel(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">val</span> standingTestLabel = HeroQueryTest::isStanding.testLabel(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">val</span> jumpingTestLabel = HeroQueryTest::isJumping.testLabel(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">val</span> testGroupLabel = <span class="hljs-string">"when <span class="hljs-subst">$state</span>"</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> KProperty&lt;<span class="hljs-built_in">Boolean</span>&gt;.action: String <span class="hljs-keyword">get</span>() = <span class="hljs-keyword">this</span>.name.substring(<span class="hljs-number">2</span>).toLowerCase()
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> KProperty<span class="hljs-type">&lt;Boolean&gt;</span>.<span class="hljs-title">testLabel</span><span class="hljs-params">(owner: <span class="hljs-type">Any</span>)</span></span>: String = <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.getter.call(owner)) <span class="hljs-string">"should be <span class="hljs-subst">${this.action}</span>"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"shouldn't be <span class="hljs-subst">${this.action}</span>"</span>
}</code></pre>
<p>Regardless of the internal implementation, we transform our test case, utilizing the newly defined DTO:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroTests</span> : <span class="hljs-type">Spek</span></span>({
    describe(<span class="hljs-string">"query methods"</span>) {
        listOf(
                HeroQueryTest(<span class="hljs-string">"created"</span>, isRunning = <span class="hljs-literal">false</span>, isJumping = <span class="hljs-literal">false</span>, isStanding = <span class="hljs-literal">true</span>, subject = Hero()),
                HeroQueryTest(<span class="hljs-string">"running"</span>, isRunning = <span class="hljs-literal">true</span>, isJumping = <span class="hljs-literal">false</span>, isStanding = <span class="hljs-literal">false</span>, subject = Hero().apply { run() }),
                HeroQueryTest(<span class="hljs-string">"jumping"</span>, isRunning = <span class="hljs-literal">false</span>, isJumping = <span class="hljs-literal">true</span>, isStanding = <span class="hljs-literal">false</span>, subject = Hero().apply { jump() }),
                HeroQueryTest(<span class="hljs-string">"standing"</span>, isRunning = <span class="hljs-literal">false</span>, isJumping = <span class="hljs-literal">false</span>, isStanding = <span class="hljs-literal">true</span>, subject = Hero().apply { stand() })
        ).forEach { test -&gt;
            describe(test.testGroupLabel) {
                it(test.runningTestLabel) {
                    expect(test.isRunning) { test.subject.isRunning }
                }

                it(test.jumpingTestLabel) {
                    expect(test.isJumping) { test.subject.isJumping }
                }

                it(test.standingTestLabel) {
                    expect(test.isStanding) { test.subject.isStanding }
                }
            }
        }
    }
})</code></pre>
<p>This looks much nicer - named arguments can be used to rearrange constructor arguments in a way that would make the &quot;table&quot; more readable. At the same time, named arguments are also used to avoid any confusion regarding the meaning of the test data. Not to mention that all of our actual test definitions became clearer and are much easier to follow.</p>
<h3>Using a factory to configure the test subject</h3>
<p>In real projects, configuring the subject may be much more complicated. In those cases, a factory object can be used to isolate that complexity, and to provide a readable name for the configured object:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-keyword">object</span> HeroFactory {
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">default</span>: Hero <span class="hljs-keyword">get</span>() = Hero()
    <span class="hljs-keyword">val</span> running: Hero <span class="hljs-keyword">get</span>() = Hero().apply { run() }
    <span class="hljs-keyword">val</span> standing: Hero <span class="hljs-keyword">get</span>() = Hero().apply { stand() }
    <span class="hljs-keyword">val</span> jumping: Hero <span class="hljs-keyword">get</span>() = Hero().apply { jump() }
}</code></pre>
<p>rendering our test &quot;table&quot; even more readable:</p>
<pre><code>    HeroQueryTest(&quot;created&quot;, isRunning = false, isJumping = false, isStanding = true, subject = HeroFactory.default),
    HeroQueryTest(&quot;running&quot;, isRunning = true, isJumping = false, isStanding = false, subject = HeroFactory.running),
    HeroQueryTest(&quot;jumping&quot;, isRunning = false, isJumping = true, isStanding = false, subject = HeroFactory.jumping),
    HeroQueryTest(&quot;standing&quot;, isRunning = false, isJumping = false, isStanding = true, subject = HeroFactory.standing)
</code></pre>
<h3>Improving the factory</h3>
<p>We can go even a bit further, and combine the state label with the configured subject in the factory, returning an instance of a DTO holding both the state label and the subject. This approach is, of course, specific to the particular use case:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConfiguredHero</span></span>(<span class="hljs-keyword">val</span> subject: Hero, <span class="hljs-keyword">val</span> stateLabel: String)

<span class="hljs-keyword">object</span> HeroFactory {
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">default</span>: ConfiguredHero <span class="hljs-keyword">get</span>() = ConfiguredHero(Hero(), <span class="hljs-string">"created"</span>)
    <span class="hljs-keyword">val</span> running: ConfiguredHero <span class="hljs-keyword">get</span>() = ConfiguredHero(Hero().apply { run() }, <span class="hljs-string">"running"</span>)
    <span class="hljs-keyword">val</span> standing: ConfiguredHero <span class="hljs-keyword">get</span>() = ConfiguredHero(Hero().apply { stand() }, <span class="hljs-string">"standing"</span>)
    <span class="hljs-keyword">val</span> jumping: ConfiguredHero <span class="hljs-keyword">get</span>() = ConfiguredHero(Hero().apply { jump() }, <span class="hljs-string">"jumping"</span>)
}

<span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeroQueryTest</span></span>(<span class="hljs-keyword">val</span> configuration: ConfiguredHero, <span class="hljs-keyword">val</span> isRunning: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isJumping: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> isStanding: <span class="hljs-built_in">Boolean</span>) {
    <span class="hljs-keyword">val</span> state = configuration.stateLabel
    <span class="hljs-keyword">val</span> subject = configuration.subject
    <span class="hljs-comment">// the remaining implementation remains untouched</span>
}</code></pre>
<p>Using this configuration makes our test definitions tidier than ever, while retaining the granularity of feedback we had on our first iteration:</p>
<pre><code>    HeroQueryTest(HeroFactory.default, isRunning = false, isJumping = false, isStanding = true),
    HeroQueryTest(HeroFactory.running, isRunning = true, isJumping = false, isStanding = false),
    HeroQueryTest(HeroFactory.jumping, isRunning = false, isJumping = true, isStanding = false),
    HeroQueryTest(HeroFactory.standing, isRunning = false, isJumping = false, isStanding = true)
</code></pre>
<h2>Spock test revisited</h2>
<p>Let&#x27;s define the Spock example from the beginning of this article using our approach:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MathTests</span> : <span class="hljs-type">Spek</span></span>({
    <span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaxTest</span></span>(<span class="hljs-keyword">val</span> a: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> c: <span class="hljs-built_in">Int</span>)
    describe(<span class="hljs-string">"max"</span>) {
        listOf(
                MaxTest(a = <span class="hljs-number">1</span>, b = <span class="hljs-number">3</span>, c = <span class="hljs-number">3</span>),
                MaxTest(a = <span class="hljs-number">7</span>, b = <span class="hljs-number">4</span>, c = <span class="hljs-number">4</span>),
                MaxTest(a = <span class="hljs-number">0</span>, b = <span class="hljs-number">0</span>, c = <span class="hljs-number">0</span>)
        ).forEach { test -&gt;
            it(<span class="hljs-string">"calculates maximum of <span class="hljs-subst">${test.a}</span> and <span class="hljs-subst">${test.b}</span> as <span class="hljs-subst">${test.c}</span>"</span>) {
                expect(test.c) { Math.max(test.a, test.b) }
            }
        }
    }
})</code></pre>
<p>This test case is only one line longer than the original, readable and maintainable, but feels more cluttered.</p>
<p>Let&#x27;s see if we can implement an approximation of the pipe syntax. Since | is unavailable as a function name, we can use the uppercase <code>I</code> instead:</p>
<pre><code class="hljs language-kotlin">    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-built_in">Int</span>.<span class="hljs-title">I</span><span class="hljs-params">(other: <span class="hljs-type">Int</span>)</span></span>: List&lt;<span class="hljs-built_in">Int</span>&gt; = listOf(<span class="hljs-keyword">this</span>, other)
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> List<span class="hljs-type">&lt;Int&gt;</span>.<span class="hljs-title">I</span><span class="hljs-params">(other: <span class="hljs-type">Int</span>)</span></span>: List&lt;<span class="hljs-built_in">Int</span>&gt; = <span class="hljs-keyword">this</span> + listOf(other)</code></pre>
<p>This way we could define our data table by listing numbers separated by <code>I</code>s. The resulting list should be fed into a factory to produce our DTO:</p>
<pre><code class="hljs language-kotlin">        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">maxTest</span><span class="hljs-params">(values: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Int</span>&gt;)</span></span>: MaxTest = MaxTest(values[<span class="hljs-number">0</span>], values[<span class="hljs-number">1</span>], values[<span class="hljs-number">2</span>])</code></pre>
<p>on the result of which we can call <code>apply</code> to get rid of all of the <code>test.</code> prefixes. This is the final form of the test case:</p>
<pre><code class="hljs language-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MathTests</span> : <span class="hljs-type">Spek</span></span>({
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MaxTest</span></span>(<span class="hljs-keyword">val</span> a: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> c: <span class="hljs-built_in">Int</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">maxTest</span><span class="hljs-params">(values: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Any</span>&gt;)</span></span>: MaxTest = MaxTest(values[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">Int</span>, values[<span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">Int</span>, values[<span class="hljs-number">2</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">Int</span>)
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> Any.<span class="hljs-title">I</span><span class="hljs-params">(other: <span class="hljs-type">Any</span>)</span></span>: List&lt;Any&gt; = listOf(<span class="hljs-keyword">this</span>, other)
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> List<span class="hljs-type">&lt;Any&gt;</span>.<span class="hljs-title">I</span><span class="hljs-params">(other: <span class="hljs-type">Any</span>)</span></span>: List&lt;Any&gt; = <span class="hljs-keyword">this</span> + listOf(other)

    describe(<span class="hljs-string">"max"</span>) {
        listOf(
                <span class="hljs-number">1</span> I <span class="hljs-number">3</span> I <span class="hljs-number">3</span>,
                <span class="hljs-number">7</span> I <span class="hljs-number">4</span> I <span class="hljs-number">4</span>,
                <span class="hljs-number">0</span> I <span class="hljs-number">0</span> I <span class="hljs-number">0</span>
        ).forEach { <span class="hljs-keyword">data</span> -&gt;
            maxTest(<span class="hljs-keyword">data</span>).apply {
                it(<span class="hljs-string">"calculates maximum of <span class="hljs-subst">$a</span> and <span class="hljs-subst">$b</span> as <span class="hljs-subst">$c</span>"</span>) {
                    expect(c) { Math.max(a, b) }
                }
            }
        }
    }
})</code></pre>
<p>Although the data table now looks cleaner, and has become generic, it has lost it&#x27;s labels, and the indentation won&#x27;t be maintained by the IDE, as is the case with Spock. The latter means that in reality this table will become an unreadable mess, meaning that we&#x27;d be better off with the DTO constructor using labelled arguments.</p>
<h1>Conclusion</h1>
<p>Although we were unable to fully replicate the simplicity of Spock&#x27;s data tables, the end result became more flexible and powerful. We have discovered a way to create clean and maintainable data-driven tests with Spek, and even made one row in our data &quot;table&quot; generate several named assertions.</p>
<p>The shortest implementation can be made by using lists of arbitrary objects to hold the test data, but it would be hard to maintain. By introducing a few DTOs and a factory object, we have been able to increase both usability and maintainability of the test suite. And although the DTOs are tightly coupled to the test, the factory could be easily reused elsewhere in the test suite. Even so, the size of the whole test case is still kept under 50 lines of code, as opposed to a hundred lines of duplicated unmaintainable test code for the regular, non-data-driven approach.</p>

      
      <div class="main-content-backlink">
        <hr/>
        <a href='http://kotlin.link/'>&larr; Back to kotlin.link</a>
      </div>
    </div>
  </section>

  <script>
    var menuLink = document.querySelector('.menu-link');

    var listener = function() {
      this.class = 'active';
      this.layout = document.getElementById('layout');
      this.handleEvent = function() {
        this.layout.classList.toggle(this.class);
      };
      this.handleEvent();
    };

    menuLink.addEventListener("click", function(){listener();}, false);
  </script>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
    (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
        try {
          w.yaCounter35722810 = new Ya.Metrika({id:35722810,
            webvisor:true,
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true});
        } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
  </script>
  <noscript><div><img src="//mc.yandex.ru/watch/35722810" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->
</body>
</html>
